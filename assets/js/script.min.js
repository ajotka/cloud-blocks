"use strict";Vue.component("admin-notice",{data:function a(){return{activeTimeout:-1}},template:"\n    <div\n      :class=\"['fgc-notification', notification.class]\"\n      v-cloak>\n      <p v-html=\"notification.text\"></p>\n    </div>\n  ",watch:{isActive:function a(){this.showingTimeout()}},mounted:function a(){this.showingTimeout()},methods:{showingTimeout:function b(){var a=this;window.clearTimeout(this.activeTimeout),this.activeTimeout=window.setTimeout(function(){window.store.state.notification.class="",a.isShowing=!1},4e3)}},computed:{isActive:function a(){return window.store.state.notification.text},notification:function a(){return window.store.state.notification}}}),Vue.component("block-card",{props:["block"],data:function a(){return{installing:!1,alreadyInstaleld:!1,updateAvailable:!1,currentVersion:null}},template:"\n    <div class=\"theme\">\n      <div class=\"theme-screenshot\">\n        <img :src=\"block.imageUrl\" :alt=\"block.name\">\n        <div class=\"spinner installing-block\" v-if=\"installing\"></div>\n      </div>\n\n      <div v-if=\"alreadyInstaleld\" class=\"notice inline notice-success notice-alt\"><p>Installed</p></div>\n\n      <div v-if=\"updateAvailable\" class=\"update-message notice inline notice-warning notice-alt\">\n        <p>New version available. <button class=\"button-link\" type=\"button\" @click=\"updateBlock\">Update now</button></p>\n      </div>\n\n      <span class=\"more-details\" @click=\"openMoreDetails\">Show more details</span>\n\n      <div class=\"theme-id-container\">\n        <h3 class=\"theme-name\">{{ block.name }}</h3>\n        <span class=\"block-version\">Version: {{ currentVersion }}</span>\n\n        <div class=\"theme-actions\">\n          <button class=\"button button-primary theme-install install-block-btn\"\n              v-if=\"currentBrowsState != 'installed' && !alreadyInstaleld\"\n              @click.prevent=\"installBlock\">\n              Install\n          </button>\n          <button class=\"button theme-install install-block-btn\"\n              v-else\n              @click.prevent=\"deleteBlock\">\n              Delete\n          </button>\n          <a class=\"button preview install-theme-preview\" :href=\"block.infoUrl\" target=\"_blank\">More details</a>\n        </div>\n      </div>\n\n    </div>\n  ",mounted:function b(){var a=this;this.currentVersion=this.block.version,!window.store.state.installedBlocks.filter(function(c){return c.package_name==a.block.packageName}).length||(this.alreadyInstaleld="installed"!=this.currentBrowsState,"installed"==this.currentBrowsState&&(this.updateAvailable=!!window.store.state.installedBlocks.filter(function(c){return c.block_version<a.block.version}).length,this.currentVersion=window.store.state.installedBlocks.filter(function(c){return c.package_name==a.block.packageName})[0].block_version))},methods:{installBlock:function c(){var a=this;this.installing=!0;var b=this.block;jQuery.ajax({type:"POST",url:fgcData.ajaxUrl,data:{action:"fgc_install_block",data:b}}).done(function(b){a.installing=!1,a.alreadyInstaleld=!0,a.incrementInstalls(a.block.packageName),window.store.dispatch("getInstalledBlocks"),window.store.commit("setNotification",{text:"Block <b>".concat(a.block.name,"</b> have been installed successfully."),class:"show success"}),console.log("Block installed ",b.data)}).fail(function(b){a.installing=!1,console.log("There is some issues installing block: ",b)})},deleteBlock:function c(){var a=this;this.installing=!0;var b=this.block;jQuery.ajax({type:"POST",url:fgcData.ajaxUrl,data:{action:"fgc_delete_block",data:b}}).done(function(b){a.installing=!1,a.alreadyInstaleld=!1,window.store.dispatch("getInstalledBlocks"),window.store.commit("setNotification",{text:"Block <b>".concat(a.block.name,"</b> have been uninstalled successfully."),class:"show success"}),console.log("Block uninstalled ",b.data)}).fail(function(b){a.installing=!1,console.log("There is some issues uninstalling block: ",b)})},updateBlock:function c(){var a=this;this.installing=!0;var b=this.block;jQuery.ajax({type:"POST",url:fgcData.ajaxUrl,data:{action:"fgc_update_block",data:b}}).done(function(b){a.installing=!1,a.updateAvailable=!1,a.currentVersion=a.block.version,window.store.dispatch("getInstalledBlocks"),window.store.commit("setNotification",{text:"Block <b>".concat(a.block.name,"</b> have been updated successfully."),class:"show success"}),console.log("Block Updated ",b.data)}).fail(function(b){a.installing=!1,console.log("There is some issues updating block: ",b)})},incrementInstalls:function b(a){jQuery.ajax({type:"PUT",url:"https://api.gutenbergcloud.org/blocks/".concat(a)}).done(function(){console.log("Installation counter increased ")}).fail(function(a){console.log("Some errors occured white increasing number of installs: ",a)})},openMoreDetails:function a(){this.block.infoUrl&&window.open(this.block.infoUrl,"_blank")}},computed:{currentBrowsState:function a(){return window.store.state.browsState}}}),Vue.component("explorer-filter",{componenets:["filter-drawer"],data:function a(){return{drawerFilterOpen:!1,filterLinks:[{name:"Installed",slug:"installed"},{name:"Popular",slug:"popular"},{name:"Latest",slug:"latest"},{name:"Most used",slug:"mostused"}]}},template:"\n    <div class=\"wp-filter g-blocks-filter hide-if-no-js\">\n      <div class=\"filter-count\">\n        <span class=\"count theme-count\">{{ installedBlocksCount }}</span>\n      </div>\n\n      <ul class=\"filter-links\">\n        <li><a v-for=\"filter in filterLinks\" :key=\"filter.slug\" @click=\"filterLink(filter.slug)\" :class=\"currentFilter(filter.slug)\">{{ filter.name }}</a></li>\n      </ul>\n\n      <button type=\"button\" id=\"searchFilter\" class=\"button drawer-toggle\" :aria-expanded=\"drawerFilterOpen\" @click=\"drawerFilterOpen = !drawerFilterOpen\">Filter</button>\n\n      <form class=\"search-form\"><label class=\"screen-reader-text\" for=\"wp-filter-search-input\">Search for blocks</label><input placeholder=\"Search blocks...\" type=\"search\" aria-describedby=\"live-search-desc\" id=\"wp-filter-search-input\" class=\"wp-filter-search\"></form>\n\n      <filter-drawer :style=\"{display: drawerFilterOpen ? 'block' : 'none'}\"></filter-drawer>\n    </div>\n  ",mounted:function a(){},methods:{filterLink:function c(a){var b=window.location.search.replace(/\&brows[=a-z]*/,"");history.pushState({state:a},null,"".concat(b,"&brows=").concat(a)),window.store.commit("setBrowsState",a)},currentFilter:function b(a){return window.store.state.browsState==a?"current":""}},computed:{installedBlocksCount:function a(){return window.store.state.installedBlocks.length}}}),Vue.component("filter-drawer",{template:"\n    <div class=\"filter-drawer\">\n      <div class=\"buttons\">\n        <button type=\"button\" class=\"apply-filters button\">Apply Filters<span></span></button>\n        <button type=\"button\" class=\"clear-filters button\" aria-label=\"Clear all filters\">Clear</button>\n      </div>\n      <fieldset class=\"filter-group\">\n        <legend>Subject</legend>\n        <div class=\"filter-group-feature\">\n          <input type=\"checkbox\" id=\"filter-id-blog\" value=\"blog\">\n          <label for=\"filter-id-blog\">Blog</label>\n          <input type=\"checkbox\" id=\"filter-id-e-commerce\" value=\"e-commerce\">\n          <label for=\"filter-id-e-commerce\">E-Commerce</label>\n          <input type=\"checkbox\" id=\"filter-id-education\" value=\"education\">\n          <label for=\"filter-id-education\">Education</label>\n          <input type=\"checkbox\" id=\"filter-id-entertainment\" value=\"entertainment\">\n          <label for=\"filter-id-entertainment\">News</label>\n        </div>\n      </fieldset>\n      <fieldset class=\"filter-group\">\n        <legend>Features</legend>\n        <div class=\"filter-group-feature\">\n          <input type=\"checkbox\" id=\"filter-id-accessibility-ready\" value=\"accessibility-ready\">\n          <label for=\"filter-id-accessibility-ready\">Custom Colors</label>\n          <input type=\"checkbox\" id=\"filter-id-custom-background\" value=\"custom-background\">\n          <label for=\"filter-id-custom-background\">Editor style</label>\n          <input type=\"checkbox\" id=\"filter-id-custom-colors\" value=\"custom-colors\">\n          <label for=\"filter-id-custom-colors\">Full Width Template</label>\n        </div>  \n      </fieldset>\n      <fieldset class=\"filter-group\">\n        <legend>Layout</legend>\n        <div class=\"filter-group-feature\">\n          <input type=\"checkbox\" id=\"filter-id-grid-layout\" value=\"grid-layout\">\n          <label for=\"filter-id-grid-layout\">Grid-layout</label>\n          <input type=\"checkbox\" id=\"filter-id-one-column\" value=\"one-column\">\n          <label for=\"filter-id-one-column\">One Column</label>\n          <input type=\"checkbox\" id=\"filter-id-two-columns\" value=\"two-columns\">\n          <label for=\"filter-id-two-columns\">Two Column</label>\n          <input type=\"checkbox\" id=\"filter-id-three-columns\" value=\"three-columns\">\n          <label for=\"filter-id-three-columns\">Responsive</label>\n        </div>\n      </fieldset>\n      <div class=\"buttons\">\n        <button type=\"button\" class=\"apply-filters button\">Apply Filters<span></span></button>\n        <button type=\"button\" class=\"clear-filters button\" aria-label=\"Clear all filters\">Clear</button>\n      </div>\n\n    </div>\n  "});var store=new Vuex.Store({state:{notification:{},browsState:null,installedBlocks:fgcData.installedBlocks},mutations:{setNotification:function c(a,b){a.notification=b},setBrowsState:function c(a,b){a.browsState=b},setInstalledBlocks:function c(a,b){a.installedBlocks=b}},actions:{getInstalledBlocks:function b(a){jQuery.ajax({type:"GET",url:fgcData.ajaxUrl,data:{action:"fgc_get_all_blocks"}}).done(function(b){a.commit("setInstalledBlocks",b.data)}).fail(function(a){console.log("There is some issues installing block: ",a)})}}}),app=new Vue({el:"#blockExplorer",data:function a(){return{blocks:[]}},created:function a(){window.store.dispatch("getInstalledBlocks")},mounted:function b(){var a=this.getUrlParams("brows")?this.getUrlParams("brows"):"installed";this.getBlocks(a),window.store.commit("setBrowsState",a),window.addEventListener("popstate",this.fetchBlocks)},watch:{currentBrowsFilter:function b(a){window.store.dispatch("getInstalledBlocks"),this.getBlocks(a)},installedBlocks:function d(a,b){var c=this.getUrlParams("brows")?this.getUrlParams("brows"):"installed";a.length!=b.length&&"installed"==c&&(this.blocks=this.blocks.filter(function(b){return a.some(function(a){return a.package_name==b.packageName})}))}},methods:{fetchBlocks:function c(a){var b=null;a.state&&(b=a.state.state),this.getBlocks(b)},getBlocks:function d(a){var b=this,c=[];jQuery.get("https://api.gutenbergcloud.org/blocks",function(d){d.rows.map(function(d){var e={};e.jsUrl="https://unpkg.com/".concat(d.name,"@").concat(d.version,"/").concat(d.config.js),e.cssUrl="https://unpkg.com/".concat(d.name,"@").concat(d.version,"/").concat(d.config.css),e.infoUrl="https://www.npmjs.com/package/".concat(d.name),e.imageUrl="https://unpkg.com/".concat(d.name,"@").concat(d.version,"/").concat(d.config.screenshot),e.name=d.config.name,e.version=d.version,e.packageName=d.name,null==a||"installed"==a?b.installedBlocks.length&&b.installedBlocks.filter(function(a){return a.package_name==e.packageName}).length&&c.push(e):c.push(e)})}),this.blocks=c},getUrlParams:function e(a,b){b||(b=window.location.href),a=a.replace(/[\[\]]/g,"\\$&");var c=new RegExp("[?&]"+a+"(=([^&#]*)|&|#|$)"),d=c.exec(b);return d?d[2]?decodeURIComponent(d[2].replace(/\+/g," ")):"":null}},computed:{currentBrowsFilter:function a(){return window.store.state.browsState},installedBlocks:function a(){return window.store.state.installedBlocks}}});
